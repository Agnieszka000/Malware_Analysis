Malware Analysis - exercise 1
malware source: https://github.com/jstrosch/malware-samples/tree/master/binaries/turkojan/2020/February

STATIC ANALYSIS:

File type:
→ PE32 executable (GUI) Intel 80386, for MS Windows, UPX compressed
→ headers: MZ, 4D5A; PE, 5045

Fingerprinting:
→ MD5 53aa23b5ca5a46a7af7d15404fb80170
→ SHA1 17a68bd6c1a548ca2bb12de8e648d6ce0e2c1a7a
→ SHA 256 ac14a9c8c3303318670e6bfe019f3a41d9411a4dc4f797f8477f1d1074459237

VirusTotal:
Popular threat label → trojan.turkojan/cak
Threat categories: trojan

Unpacking:
Program with .bin extension packed with UPX. Unpacked to .exe with upx command.

Strings:
Before unpacking: KERNEL32.DLL; netapi32.dll; advapi32.dll (services: security, registry, event logging, user account management)
MZP; This program must be run under Win32; UPX!;
After unpacking:
GetWindowText; GetDesktopWindow; Adjust Token Privileges; RehSetalueEx; GetCurrentProcessID; getsockname; bind; listen; recv; WriteFile;CreateProcess; ShellExecute; CreateRemoteThread; StartUp; AppData
D:\turkojan4\completed\Server\Kol.pas; getimpasswords; getftppasswords; mailpasswords; dialpasswords; downloaderpasswords; TClientSocket; HTTP/1.1; taskmgr.exe; Turkojan Server; http://www.turkojan.com; rootkit; nApiHook
SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
	
CONCLUSION:
This is a Windows executable file (PE32), compressed with UPX. Thanks to the hashes we can find out that it is classified as trojan on VirusTotal. After unpacking the strings reveal that the program uses such techniques as Access Token Manipulation, Registry Modification, Process Injection, Hooking, Remote File Copy and Execution Through API.
